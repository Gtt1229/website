<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Monolithization | Oat++</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/logo_x64.png"><link rel='canonical' href='https://oatpp.io/docs/monolithization/'/>
    <meta name="description" content="Monolithization of microservices in Oat++ Web Framework.">
    <link rel="preload" href="/assets/css/0.styles.5f58b113.css" as="style"><link rel="preload" href="/assets/js/app.4c0e249b.js" as="script"><link rel="preload" href="/assets/js/3.0e791e97.js" as="script"><link rel="preload" href="/assets/js/306.faaea859.js" as="script"><link rel="preload" href="/assets/js/7.a7c042c4.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.5f58b113.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://raw.githubusercontent.com/lganzzzo/oatpp-website-res/master/logo_x400.png" alt="Oat++" class="logo"> <span class="site-name can-hide">Oat++</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/start/" class="nav-link">
  Quick Start
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div><div class="nav-item"><a href="/support/" class="nav-link">
  Support
</a></div> <a href="https://github.com/oatpp/oatpp" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/start/" class="nav-link">
  Quick Start
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div><div class="nav-item"><a href="/support/" class="nav-link">
  Support
</a></div> <a href="https://github.com/oatpp/oatpp" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>About</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Benchmark</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Examples</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Installation</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Start</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Overview</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/components/api-controller/" class="sidebar-link">Api Controller</a></li><li><a href="/docs/components/api-client/" class="sidebar-link">Api Client</a></li><li><a href="/docs/components/dto/" class="sidebar-link">Data Transfer Object (DTO)</a></li><li><a href="/docs/components/orm/" class="sidebar-link">ORM Framework</a></li><li><a href="/docs/monolithization/" aria-current="page" class="active sidebar-link">Monolithization</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/monolithization/#example" class="sidebar-link">Example</a></li><li class="sidebar-sub-header"><a href="/docs/monolithization/#the-problem" class="sidebar-link">The Problem</a></li><li class="sidebar-sub-header"><a href="/docs/monolithization/#the-concept-of-monolithization" class="sidebar-link">The Concept of Monolithization</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/monolithization/#service-interfaces" class="sidebar-link">Service Interfaces</a></li><li class="sidebar-sub-header"><a href="/docs/monolithization/#build-pipeline" class="sidebar-link">Build Pipeline</a></li><li class="sidebar-sub-header"><a href="/docs/monolithization/#scaling" class="sidebar-link">Scaling</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/monolithization/#performance" class="sidebar-link">Performance</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/monolithization/#requests-per-second" class="sidebar-link">Requests Per Second</a></li><li class="sidebar-sub-header"><a href="/docs/monolithization/#memory-usage-mb" class="sidebar-link">Memory Usage (Mb)</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/monolithization/#links" class="sidebar-link">Links</a></li></ul></li><li><a href="/docs/features/upload-file/" class="sidebar-link">Upload File</a></li><li><a href="/docs/oatpp-coroutines/" class="sidebar-link">Coroutines</a></li><li><a href="/docs/simple-vs-async/" class="sidebar-link">Simple vs Async</a></li><li><a href="/docs/async/" class="sidebar-link">Async</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Modules</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>API Reference</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="monolithization"><a href="#monolithization" class="header-anchor">#</a> Monolithization <div data-v-4414e9e8></div></h1> <p>Monolithization is the technique that enables you to scale your microservices better.
You can develop regular microservices in Oat++, and when there is a little to no load in your system,
you can consolidate your services in a single monolith. Also, consolidated services perform better and consume less memory.
Thus you can reduce your infrastructure costs by reducing network overhead and minimizing the number of running instances.</p> <p>The best way to understand Monolithization and how it works is through example.</p> <p></p><div class="table-of-contents"><ul><li><a href="#example">Example</a></li><li><a href="#the-problem">The Problem</a></li><li><a href="#the-concept-of-monolithization">The Concept of Monolithization</a><ul><li><a href="#service-interfaces">Service Interfaces</a></li><li><a href="#build-pipeline">Build Pipeline</a></li><li><a href="#scaling">Scaling</a></li></ul></li><li><a href="#performance">Performance</a><ul><li><a href="#requests-per-second">Requests Per Second</a></li><li><a href="#memory-usage-mb">Memory Usage (Mb)</a></li></ul></li><li><a href="#links">Links</a></li></ul></div><p></p> <h2 id="example"><a href="#example" class="header-anchor">#</a> Example</h2> <p>Consider the following system consisting of three trivial microservices:</p> <ul><li>User Service</li> <li>Book Service</li> <li>Facade</li></ul> <img alt="Example microservices system" src="https://raw.githubusercontent.com/lganzzzo/oatpp-website-res/master/website/monolithization/svg/load-setup.svg?sanitize=true" width="650px"> <p>Facade requests user information from User-Service, book information from Book-Service. Then merges the data and returns to the client.</p> <h2 id="the-problem"><a href="#the-problem" class="header-anchor">#</a> The Problem</h2> <p>When there is a little load in this system, there is no need to scale its parts.
Thus it would be better to have this system as a monolith in order not to spawn multiple instances or containers.
But you want to keep microservices architecture, in order to be flexible in the future when there is a load.</p> <p>You could probably deploy all services on a single instance running in separate processes.
But in this case, it's additional dev-ops effort. Plus, you still have the network overhead, as communicating through localhost decreases performance.</p> <h2 id="the-concept-of-monolithization"><a href="#the-concept-of-monolithization" class="header-anchor">#</a> The Concept of Monolithization</h2> <p>The concept is simple. - We are going to put all the services in a single process.
And we are going to make services communicate through the Oat++ <strong>virtual connections</strong>.</p> <img alt="Monolithization concept" src="https://raw.githubusercontent.com/lganzzzo/oatpp-website-res/master/website/monolithization/svg/microservices-monolithizated.svg?sanitize=true" width="500px"> <p>The Oat++ virtual connections substitute the network transport layer, so that your application logic can stay isolated.
And they utilize internal buffers so that there is no network overhead as in case of communicating through the localhost.</p> <h3 id="service-interfaces"><a href="#service-interfaces" class="header-anchor">#</a> Service Interfaces</h3> <p>Consolidated services can keep their network interfaces, to be available for remote services.
And they have to expose the virtual interface to communicate with consolidated services via virtual connections.</p> <img alt="Service interfaces" src="https://raw.githubusercontent.com/lganzzzo/oatpp-website-res/master/website/monolithization/svg/monolithization-interfaces.svg?sanitize=true" width="600px"> <h3 id="build-pipeline"><a href="#build-pipeline" class="header-anchor">#</a> Build Pipeline</h3> <p>The good thing is that you don't have to change your build pipeline. Each team can develop its microservices independently from others.<br>
All you need to do is to create a monolithic configuration for each set of microservices you want to consolidate.</p> <img alt="Build pipeline" src="https://storage.googleapis.com/website-res/building-monolith.svg" width="600px"> <h3 id="scaling"><a href="#scaling" class="header-anchor">#</a> Scaling</h3> <p>With Monolithization, you can scale gradually.
Step by step, adding new monolithic deployments and decoupling your monolith into smaller pieces so that you can achieve the best configuration for your cloud.</p> <table style="width:100%;"><tr><th>Step 1</th> <th>Step 2</th> <th>Step 3</th></tr> <tr><td><img alt="Scaling step 1" src="https://raw.githubusercontent.com/lganzzzo/oatpp-website-res/master/website/monolithization/svg/decoupling-1.svg?sanitize=true" width="180px"></td> <td><img alt="Scaling step 2" src="https://raw.githubusercontent.com/lganzzzo/oatpp-website-res/master/website/monolithization/svg/decoupling-2.svg?sanitize=true" width="300px"></td> <td><img alt="Scaling step 3" src="https://raw.githubusercontent.com/lganzzzo/oatpp-website-res/master/website/monolithization/svg/decoupling-3.svg?sanitize=true" width="400px"></td></tr></table> <h2 id="performance"><a href="#performance" class="header-anchor">#</a> Performance</h2> <p>Below is the performance comparison of Oat++ microservices(deployed on the same instance) versus same microservices consolidated via Monolithization.</p> <img alt="Performance test setup" src="https://raw.githubusercontent.com/lganzzzo/oatpp-website-res/master/website/monolithization/svg/load-monolithizated.svg?sanitize=true" width="650px"> <h3 id="requests-per-second"><a href="#requests-per-second" class="header-anchor">#</a> Requests Per Second</h3> <img alt="Requests per second" src="https://raw.githubusercontent.com/lganzzzo/oatpp-website-res/master/website/monolithization/svg/micro-vs-monolith.svg?sanitize=true" width="800px"> <h3 id="memory-usage-mb"><a href="#memory-usage-mb" class="header-anchor">#</a> Memory Usage (Mb)</h3> <table><thead><tr><th></th> <th>Facade</th> <th>User Service</th> <th>Book Service</th> <th>Total</th></tr></thead> <tbody><tr><td>Oat++ (micro-svc) idle</td> <td>25</td> <td>3</td> <td>3</td> <td>31</td></tr> <tr><td>Oat++ (micro-svc) load</td> <td>45</td> <td>3.2</td> <td>3.2</td> <td>49.4</td></tr> <tr><td>Oat++ (monolith) idle</td> <td>-</td> <td>-</td> <td>-</td> <td>26.7</td></tr> <tr><td>Oat++ (monolith) load</td> <td>-</td> <td>-</td> <td>-</td> <td>37.7</td></tr></tbody></table> <h2 id="links"><a href="#links" class="header-anchor">#</a> Links</h2> <p><a href="https://github.com/oatpp/example-microservices" target="_blank" rel="noopener noreferrer">Example Project Repository<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/oatpp/website/edit/master/docs/docs/monolithization/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/components/orm/" class="prev">
        ORM Framework
      </a></span> <span class="next"><a href="/docs/features/upload-file/">
        Upload File
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4c0e249b.js" defer></script><script src="/assets/js/3.0e791e97.js" defer></script><script src="/assets/js/306.faaea859.js" defer></script><script src="/assets/js/7.a7c042c4.js" defer></script>
  </body>
</html>
